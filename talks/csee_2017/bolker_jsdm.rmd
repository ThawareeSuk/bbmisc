---
title: phenomenological and mechanistic models in species distribution modeling
author: Ben Bolker
date:  8 May 2017
bibliography: csee.bib
csl: reflist2.csl
output:
  ioslides_presentation
---
<!-- 
apa.csl is a slightly hacked version of APA 
  (modified for "et al" after 2 authors in text)
-->
<!-- .refs is style for reference page (small text) -->
<style>
.refs {
   font-size: 16px;
}
h2 { 
 color: #3399ff;		
}
h3 { 
 color: #3399ff;		
}
.title-slide {
   background-color: #55bbff;
}
.forceBreak { -webkit-column-break-after: always; break-after: column; }
</style>
<!--    content: url(https://i.creativecommons.org/l/by-sa/4.0/88x31.png)
>
<!-- Limit image width and height -->
<style type="text/css">
img {     
  max-height: 560px;     
  max-width: 800px; 
}
</style>

```{r setup,echo=FALSE,message=FALSE}
library("ggplot2"); theme_set(theme_classic())
library("knitr")
opts_chunk$set(echo=FALSE,fig.width=4,fig.height=4,out.width=400)
```

# intro

## acknowledgements {.columns-2}

- "when I say 'we' ..."
- **People** 
    - Guillaume Blanchet (Sherbrooke)
    - Anna Norberg (Univ of Helsinki)
    - Otso Ovaskainen (NTNU, Univ of Helsinki)
- **Institutions** ($$$)
    - NSERC
    - NimBIOS

# data sets

## diatoms

<div style="float: left; width: 40%;">
- 7 stream systems $\times$
15 samples  
(105 samples total)
- 499 species
- *predictors*: shading, % particles, moss cover, water velocity, conductance, pH, water colour, total P
- use first 4 PCA axes

</div>

<div style="float: left; width: 60%;">
<img src="pix/diatoms.png" style="width:200px">
<img src="pix/diatom_sites.png" style="width:200px"> 

</div>

## fungi

<div style="float: left; width: 40%;">
- 29 forests  
(21 managed, 8 natural)
- 22,500 samples (logs)
- 321 species
- *predictors*: management status, log (diameter), decay class, decay class$^2$
</div>

<div style="float: left; width: 60%;">
<img src="pix/fungus1.png" style="width:200px">
<img src="pix/fungus2.png" style="width:200px">
<br>
<img src="pix/fungus_sites.png" style="width:400px">
</div>

## UK butterflies

<div style="float: left; width: 40%;">
- 2841 10 km $\times$ 10 km grid cells
- 55 species
- *predictors*: # growing days > 5 C, % broadleaf woodland, % coniferous woodland, % calcareous substrates

</div>

<div style="float: left; width: 60%;">
<table>
<tr>
<td>
<img src="pix/butterfly1.png" style="width:150px;padding:10px">
<br>
sp 1
<br>
<img src="pix/butterfly2.png" style="width:150px;padding:10px">
<br>
sp 2
<br>
<img src="pix/butterfly3.png" style="width:150px;padding:10px">
<br>
sp 3
</td>
<td>
<img src="pix/butterfly_sites.png" style="width:250px">
</td>
</tr>
</table>
</div>

## Australian plants

- 30,000 locations (600)
- 2729 species
- salinity, wetness, rainfall

## US trees

- 100,000 locations (600)
- 590 species
- first 3 PCA axes (out of 38 climate and soil variables)

# models

## Univariate (stacked SDMs)

- fit each species independently
    - **algorithmic**: boosted regression trees, random forest, support vector machine, multivariate regression trees, MARS, gradient nearest neighbour ...
    - **model-based**: GLM, GAM
- community-level predictions simply aggregate individual-species results

## Multivariate (joint SDMs)

- fit all species simultaneously, allow +/- dependencies
    - species archetype models (SAM)
    - neural networks (MISTNET)
    - hierarchical GLM (HMSC)
- potential improvement in accuracy
- more direct community-level predictions

## sampling {.columns-2}

- hierarchical (discrete) vs. spatially explicit
- interpolation vs extrapolation
- some large data sets subsampled

<img src="pix/bakeoff_cartoon1A.png" style="width:350px">


## assessment statistics {.columns-2}

- joint models *could* improve individual predictions ...
- ... but more obvious effects on community-level response

<img src="pix/bakeoff_cartoon2B.png" style="width:350px">

# results

## summary (terciles)

<img src="pix/bakeoff_summ_all_A.png" style="width:700px">
<img src="pix/bakeoff_summ_all_B.png" style="width:700px">

## summary (species occupancy: Tjur $R^2$)

## summary<br>(species occupancy: deviance)

## summary<br>(species richness: rank correlation)

## timings

# discussion

## SDM extensions

- phylogenetic information
- dispersal
- multi-trophic models

## phenomenological/mechanistic

- definition is context-dependent, e.g.
    - linear, quadratic
    - Michaelis-Menten/Monod/Beverton-Holt
- many mechanisms per phenomenon:  
cf. the  *Strong Law of Small Numbers* [@guy_strong_1988]
- **semimechanistic** models
- semimechanistic approaches (e.g @merow_developing_2011)

## model-based statistics {.columns-2}

- ecological-mechanistic $\leftrightarrow$  
model-based-statistical $\leftrightarrow$  
algorithmic-statistical
- tradeoffs
     - identifiability
	 - computational efficiency
	 - interpretability
	 - flexibility

<img src="pix/breiman.png" style="width:400px"><br>
<img src="pix/peters2.png" style="width:150px">


## References {.refs}


